# GRPCPingPong

## ТЗ
При запуске сервера нажатием кнопки – программа начинает broadcast в UDP порт 10001 сообщения, содержащего IP и порт, по которому в последствии будут подключаться gRPC клиенты. При подключении со стороны клиента запускается циклический вызов процедуры «Ping» каждые 5 секунд. Если к серверу успешно выполнено подключение (происходят вызовы процедуры «Ping»), broadcast приостанавливается, пока не пройдет timeout (15 секунд с последнего вызова «Ping»).

## Что вышло
Сделал все как в тз, кроме того что не логируется connect и disconnect клиента, тут можно было бы как то поизворачиваться, потому что совсем простых методов я не знаю, но, к сожалению, не так много на этой неделе свободного времени было.

Настроил автоматическую генерацию, надо только в переменные среды добавить:
```
GRPC_CPP_PLUGIN
```
и чтобы в переменных окружения был protoc.

С версиями возникла какая то беда, если будет стоять `Protobuf` версии `4.25.1` - срочно обновляйте! Там какие-то [беды](https://github.com/protocolbuffers/protobuf/issues/17258) с генерацией.

## Реализация клиента
Жил был класс `BroadcastListener`, любил он слушать что по порту `10001` передают. И каждый раз, когда слышал адреса отличные от тех, что слышал прежде, шел рассказывать про новый `PingConnection` к `ConnectingTableModel`.

`ConnectingTableModel` любил собирать все эти `PingConnection` в одном месте. Но их нужно уметь развлекать! Поэтому они давал им поиграть в PingPong, если адрес нравился нашему серверу.

`PingConnection` мог начать играть в пингпонг, но если ему не поступал ответ 3 раза, то он бросал игру, пока `ConnectingTableModel` снова не даст ему в нее поиграть.

## Реализация сервера
`GRPCServer` - сервер простой, пока никто с ним в пингпонг не играет, он вещает на всю публику по порту `10001`, где он играет в пингпонг. Когда кто то наконец приходит поиграть с ним, `GRPCServer` перестает кричать где он играет.
